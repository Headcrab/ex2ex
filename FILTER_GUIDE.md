# Руководство по фильтрации строк

## Обзор

Функциональность фильтрации позволяет копировать только те строки из диапазона, которые соответствуют определённой маске в указанном столбце.

## Параметры фильтрации

### filter_column
Буква столбца, в котором будет проверяться значение (например: `B`, `C`, `D`).

### filter_mask
Маска для проверки значения с поддержкой wildcards (`*`).

## Примеры масок

| Маска | Описание | Примеры совпадений |
|-------|----------|-------------------|
| `*3*` | Содержит цифру 3 | "123", "Product 3", "3.14", "2023" |
| `ABC*` | Начинается с ABC | "ABC123", "ABCDEF", "ABC" |
| `*XYZ` | Заканчивается на XYZ | "123XYZ", "TEST XYZ" |
| `A*Z` | Начинается с A и заканчивается на Z | "ABCZ", "AZ" |
| `*` | Любое значение | Все непустые ячейки |
| `2023` | Точное совпадение | "2023" |

## Пример конфигурации

```yaml
output_filename: отфильтрованный_отчет.xlsx

mappings:
  # Копирование с фильтрацией
  - source: "Лист1!A1:K21"
    destination: "Результат!A1"
    filter_column: "B"
    filter_mask: "*3*"

  # Копирование без фильтрации (все строки)
  - source: "Лист1!M2:M21"
    destination: "Результат!L1"

output_sheets:
  - name: "Результат"
    create_if_not_exists: true
```

## Как это работает

1. **Источник**: Определяется диапазон ячеек для копирования (например, `A1:K21`)
2. **Фильтр**: Для каждой строки в диапазоне проверяется значение в столбце `filter_column`
3. **Проверка маски**: Если значение соответствует `filter_mask`, вся строка копируется
4. **Назначение**: Отфильтрованные строки копируются последовательно в указанное место назначения

## Пример работы

### Исходные данные (Лист1):

| A | B | C | D |
|---|---|---|---|
| ID | Код | Название | Цена |
| 1 | A123 | Product A | 100 |
| 2 | B345 | Product B | 200 |
| 3 | C123 | Product C | 150 |
| 4 | D789 | Product D | 300 |

### Конфигурация:
```yaml
- source: "Лист1!A1:D5"
  destination: "Результат!A1"
  filter_column: "B"
  filter_mask: "*3*"
```

### Результат (Результат):

| A | B | C | D |
|---|---|---|---|
| ID | Код | Название | Цена |
| 1 | A123 | Product A | 100 |
| 3 | C123 | Product C | 150 |

**Объяснение**: Скопированы только строки, где в столбце B есть цифра "3" (A123 и C123).

## Настройка через админ-панель

1. Откройте админ-панель: `http://localhost:8080/admin`
2. Добавьте новое правило
3. Заполните поля:
   - **Источник**: `Лист1!A1:K21`
   - **Назначение**: `Результат!A1`
   - **Столбец фильтрации**: `B`
   - **Маска фильтра**: `*3*`
4. Сохраните конфигурацию

## Важные замечания

- Если `filter_column` или `filter_mask` не указаны, копируются все строки
- Фильтрация применяется только к диапазонам (не к отдельным ячейкам)
- Пустые ячейки в столбце фильтрации не соответствуют никакой маске
- Фильтрация учитывает регистр символов
- Wildcards `*` означают "любое количество любых символов"

## Дополнительные примеры

### Фильтрация по году
```yaml
filter_column: "C"
filter_mask: "2023*"
```
Скопирует строки, где столбец C начинается с "2023" (например, "2023-01-15").

### Фильтрация по категории
```yaml
filter_column: "D"
filter_mask: "*Категория А*"
```
Скопирует строки, где столбец D содержит текст "Категория А".

### Точное совпадение
```yaml
filter_column: "E"
filter_mask: "Активен"
```
Скопирует строки, где столбец E точно равен "Активен".
